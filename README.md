# Итоговый проект. Прогнозирование цены на кофе.

## Оглавление  
[1. Описание проекта](.README.md#Описание-проекта)  
[2. Какой кейс решаем?](.README.md#Какой-кейс-решаем)  
[3. Краткая информация о данных](.README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](.README.md#Этапы-работы-над-проектом)  
[5. Результат](.README.md#Результат)    
[6. Выводы](.README.md#Выводы) 

### Описание проекта    
Кофе — это сваренный напиток, приготовленный из обжаренных кофейных зерен, семян ягод некоторых цветковых растений рода Coffea. Кофе по праву считается одним из самых популярных напитков во всем мире, по своей многогранности он сравним с вином и шоколадом, что позволяет каждому найти свой напиток. 

Однако о тонкостях подготовки продукта к его итоговой форме мало кто задумывается, а ведь именно это формирует вкусоароматический профиль, которые ценит потребитель, а также итоговую цену, которую ценят закупщики во всех уголках мира.

Регион произрастания, метод обработки, степень обжарки, тип зерна и много другое формирует цену на кофе, который мы покупаем в гипермаркетах или в кофейнях. И в данном проекте мы попробуем построить модель машинного обучения, предсказывающую цену за 1 кг кофе.

:arrow_up:[к оглавлению](_)

### Какой кейс решаем?    
Определить характеристики и с их помощью спрогнозировать цену за кг кофе.

:arrow_up:[к оглавлению](_)

### Краткая информация о данных
За основу был взят датасет с площадки Kaggle (https://www.kaggle.com/datasets/schmoyote/coffee-reviews-dataset), который будет расширен и переработан.

Исходный датасет имеет 12 признаков:
* name - название кофе;
* roaster - название компании обжарщика;
* roast - степень обжарки кофе: Dark - темная, Medium-Dark - средне-темная, Medium - средняя, Medium-Light - средне-светлая, Light - светлая;
* loc_country - название страны - локация расположение обжарщика;
* origin_1 - регион_1 произрастания кофе;
* origin_2 - регион_2 произрастания кофе;
* rating - рейтинг кофе;
* review_date - дата, когда был оставлен отзыв на кофе;
* desc_1 - текстовое описание кофе №1;
* desc_2 - текстовое описание кофе №2;
* desc_3 - текстовое описание кофе №3;
* 100g_USD - цена кофе за 100 гр в долларах США (целевой признак).

В процессе работы над проектом исходны датасет был расширен рядом данных:

1. Из датасета Global Country Information Dataset 2023, взятого с площадки Kaggle (https://www.kaggle.com/datasets/nelgiriyewithana/countries-of-the-world-2023) со следующими признаками:
  * Country - название страны;
  * Density (P/Km2) - плотность населения (чел/км2);
  * Abbreviation - аббревиатура или код страны;
  * Agricultural Land (%) - процент земель, используемых под сельское хозяйство в процентах;
  * Land Area (Km2) - площадь страны в км2;
  * Armed Forces Size - численность вооруженных сил страны;
  * Birth Rate - число рожденных на 1000 человек;
  * Calling Code - международный телефонный код страны;
  * Capital/Major City - название столицы;
  * CO2 Emissions - количество выбросов углекислого газа в тоннах;
  * CPI - индекс потребительских цен, показатель инфляции и покупательной способности;
  * CPI Change (%) - процентное изменение индекса потребительских цен по сравнению с предыдущим годом;
  * Currency_Code - код валюты, используемой в стране; 
  * Fertility Rate - среднее число детей, рожденных женщиной за всю жизнь;
  * Forested Area (%) - процент территории, покрытой лесами;
  * Gasoline_Price - цена бензина за литр в местной валюте;
  * GDP - валовой внутренний продукт — общая стоимость товаров и услуг, произведенных в стране;
  * Gross Primary Education Enrollment (%) - валовой коэффициент охвата начальным образованием;
  * Gross Tertiary Education Enrollment (%) - валовой коэффициент охвата высшим образованием;
  * Infant Mortality - число смертей на 1000 живорождений в возрасте до одного года;
  * Largest City - название крупнейшего города страны;
  * Life Expectancy - среднее количество лет, которое, как ожидается, проживет новорожденный;
  * Maternal Mortality Ratio - количество материнских смертей на 100 000 живорождений;
  * Minimum Wage - уровень минимальной заработной платы в местной валюте;
  * Official Language - официальный язык(и), на котором говорят в стране;
  * Out of Pocket Health Expenditure (%) - процент общих расходов на здравоохранение, оплачиваемых физическими лицами из собственного кармана;
  * Physicians per Thousand - число врачей на тысячу человек;
  * Population - общая численность населения страны;
  * Population: Labor Force Participation (%) - Процент населения, входящего в состав рабочей силы;
  * Tax Revenue (%) - налоговые поступления в процентах от ВВП;
  * Total Tax Rate - общая налоговая нагрузка в процентах от коммерческой прибыли;
  * Unemployment Rate - процент рабочей силы, которая является безработной;
  * Urban Population - процент населения, проживающего в городских районах;
  * Latitude - координата широты местоположения страны;
  * Longitude - долгота координаты местоположения страны.
    
2. Из документа открытого ценообразования (https://docs.google.com/spreadsheets/d/1x4GZsUkzbBkAE9kyTslruu4TJSB_jULT/edit#gid=1199774536) компании The Walder Catherine	(https://theweldercatherine.ru/) со следующими признаками:
  * name - название кофе;
  * roaster - название компании обжарщика;
  * roast - степень обжарки кофе: Dark - темная, Light - светлая;
  * price_kg/USD - цена кофе за 1 кг в долларах США (целевой признак);
  * loc_country - название страны - локация расположение обжарщика;
  * origin - регион произрастания кофе;
  * method - метод обработки кофе;
  * descriptors - описание вкусо-ароматического профиля кофе;
  * rating - рейтинг кофе;
  * review_month - месяц, когда было проведено описание кофе;
  * review_year - год, когда было проведено описание кофе.
    
3. Из датасета World Coffee Exports: 1990-2019 с площадки Kaggle (https://www.kaggle.com/datasets/danbraswell/world-coffee-exports-19902019) с признаками:
  * country - название страны;
  * 1990-2019 - количество экспортируемого кофе в тысячах мешков по 60 кг;
  * all_years - сумма экспортируемых мешков с 1990 по 2019 годы для каждой страны.
  
:arrow_up:[к оглавлению](.README.md#Оглавление)

### Этапы работы над проектом  
1. Постановка задачи. В рамках этого этапа был определен вектор развития работы над проектом, были отобраны основные датасеты, которые потенциально могут быть полезны для решения поставленной задачи, проведено ознакомление со сферой, в рамках которой решается бизнес-задача.
2. Знакомство с данными. На этом этапе стояла задача подготовить данные к разведывательному анализу данных, дополнить исходный датасет сторонними признаками, преобразовать исходные признаки так, чтобы создать максимально информативный датафрейм.
3. Разведывательный анализ данных (EDA). На данном этапе с помощью инструментов визуализации были выявлены основные зависимости между признаками в целом и целевой переменной в частонсти, определены важности некоторых признаков, выявлено, как можно улучшить имеющиеся данные.
4. Отбор и преобразование признаков. На этапе преобразования были созданы новые признаки подготовленного датасета, удалены неинформативные, было произведено кодирование категоральных признаков, была выполнена проверка данных на мультиколлиниарность, отобраны 25 самых важных признаков.
5. Решение задачи регрессии. На этапе машинного обучения были построены основные модели регресии, оценены метрики каждой модели, по ним была выбрана наилучшая и к ней применен метод подбора гиперпараметров для улучшения метрик итоговой модели.

:arrow_up:[к оглавлению](.README.md#Оглавление)

### Результаты:  
Результатом проделанной работы стала модель машинного обучения (модель градиентного бустинга), которая предсказывает цену за 1 кг кофе в зависимости от ряда признаков. Качество работы этой модели отражено в метриках (R^2, MAE, MAPE).

:arrow_up:[к оглавлению](.README.md#Оглавление)


### Выводы:  
1. Познакомились с исходным датасетом, преобразовали его, дополнили данными из других датасетов, создали новые признаки;
2. С помощью инструментов визуализации выявили закономерности между признаками, определили важность некоторых признаков, определили, как можно улучшить имеющиеся данные;
3. На этапе преобразования создали новые признаки подготовленного датасета, удалили неинформативные, произвели кодирование категоральных признаков, проверили данные на мультиколлиниарность, отобрали 25 самых важных признаков;
4. На этапе машинного обучения рассмотрели основные модели регресии, оценили метрики каждой модели, по ним выбрали наилучшую и к ней применили метод подбора гиперпараметров для улучшения метрик итоговой модели.

:arrow_up:[к оглавлению](.README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами
